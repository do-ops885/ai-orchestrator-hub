  # Build summary
  build-summary:
    name: Build Summary
    runs-on: ubuntu-latest
    needs: [pre-check, rust-build, frontend-build, integration-test]
    if: always()
    permissions:
      contents: read

    steps:
      - name: Generate build summary
        run: |
          echo "::group::Build Summary"
          echo "Pre-check: ${{ needs.pre-check.result }}"
          echo "Rust build: ${{ needs.rust-build.result }}"
          echo "Frontend build: ${{ needs.frontend-build.result }}"
          echo "Integration tests: ${{ needs.integration-test.result }}"
          echo "Rust changes detected: ${{ needs.pre-check.outputs.rust-changed }}"
          echo "Frontend changes detected: ${{ needs.pre-check.outputs.frontend-changed }}"
          echo "::endgroup::"

          # Determine overall status
          if [[ "${{ needs.rust-build.result }}" == "success" || "${{ needs.rust-build.result }}" == "skipped" ]] && \
             [[ "${{ needs.frontend-build.result }}" == "success" || "${{ needs.frontend-build.result }}" == "skipped" ]] && \
             [[ "${{ needs.integration-test.result }}" == "success" || "${{ needs.integration-test.result }}" == "skipped" ]]; then
            echo "✅ Build workflow completed successfully"
            exit 0
          else
            echo "❌ Build workflow failed"
            exit 1
          fi